"use strict";(self.webpackChunkng_lazy_modules=self.webpackChunkng_lazy_modules||[]).push([[240],{6240:(k,c,u)=>{u.r(c),u.d(c,{ProfileModule:()=>j});var h=u(6814),v=u(4949),e=u(4946),n=u(95),g=u(1897),C=u(7398),T=u(6810);let A=(()=>{class t{constructor(){}saveProfileData(r){return(0,g.H)(3e3).pipe((0,C.U)(o=>{if(r.first_name.length>2)return!0;throw new Error("Error data")}))}getProfileData(){return(0,g.H)(3e3).pipe((0,C.U)(r=>(0,T.m)()))}static#e=this.\u0275fac=function(o){return new(o||t)};static#t=this.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var p=u(1993),P=u(4716),_=u(4664),x=u(1374),S=u(2181),U=u(4108),Z=u(5219),F=u(9757),M=u(3891),y=u(191),D=u(3714),I=u(3429),E=u(291);let O=(()=>{class t{constructor(r){this.el=r}onKeyDown(r){if(-1!==["Backspace","Tab","Enter","ArrowLeft","ArrowRight","Delete","Home","End"].indexOf(r.key))return;const l=r.key,f=this.el.nativeElement.value.includes("+");"+"===l&&f?r.preventDefault():/^[0-9+]$/.test(l)||r.preventDefault()}static#e=this.\u0275fac=function(o){return new(o||t)(e.Y36(e.SBq))};static#t=this.\u0275dir=e.lG2({type:t,selectors:[["","appPhoneInput",""]],hostBindings:function(o,i){1&o&&e.NdJ("keydown",function(s){return i.onKeyDown(s)})}})}return t})();function L(t,a){1&t&&(e.TgZ(0,"div",23),e._uU(1,"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435"),e.qZA())}function z(t,a){1&t&&(e.TgZ(0,"div",23),e._uU(1,"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435"),e.qZA())}function B(t,a){1&t&&(e.TgZ(0,"div",23),e._uU(1,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 email"),e.qZA())}function J(t,a){1&t&&(e.TgZ(0,"div",23),e._uU(1,"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435"),e.qZA())}function Q(t,a){1&t&&(e.TgZ(0,"div",23),e._uU(1,"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0430\u0434\u0440\u0435\u0441\u0430 \u0441\u0430\u0439\u0442\u0430"),e.qZA())}const V=[{path:"",component:(()=>{class t{constructor(){this.profileForm=new n.cw({first_name:new n.NI("",[n.kI.required,n.kI.maxLength(255)]),last_name:new n.NI("",[n.kI.required,n.kI.maxLength(255)]),email:new n.NI("",[n.kI.email]),phone_number:new n.NI("",[n.kI.pattern("^[0-9+]+$"),n.kI.required,t=>12===t.value.length?null:{invalidPhone:{value:t.value}}]),url:new n.NI("",[t=>/^(https?:\/\/)?([a-z0-9]+([\-\.][a-z0-9]+)*\.[a-z]{2,})/i.test(t.value)||!t.value.length?null:{invalidUrl:{value:t.value}}])}),this.profileService=(0,e.f3M)(A),this.loadingService=(0,e.f3M)(U.b),this.messageService=(0,e.f3M)(Z.ez),this.mainService=(0,e.f3M)(M.J),this.cdr=(0,e.f3M)(e.sBO),this.destroyRef=(0,e.f3M)(e.ktI)}ngOnInit(){this.setPhonePrefixOnInputChange(),this.getProfileData()}saveChanges(){if(this.setFormAsDirty(this.profileForm),!this.profileForm.valid)return;const r={first_name:this.profileForm.controls.first_name.value,last_name:this.profileForm.controls.last_name.value,email:this.profileForm.controls.email.value,url:this.profileForm.controls.url.value,phone_number:this.profileForm.controls.phone_number.value};this.loadingService.setLoadingStatus(!0),this.profileService.saveProfileData(r).pipe((0,P.x)(()=>this.loadingService.setLoadingStatus(!1)),(0,p.sL)(this.destroyRef)).subscribe({next:()=>this.messageService.add(F.nS),error:()=>this.messageService.add(F.c9)})}getProfileData(){this.loadingService.setLoadingStatus(!0),this.mainService.selectedProfile$.pipe((0,_.w)(r=>r?this.mainService.selectedProfile$:this.profileService.getProfileData()),(0,x.P)(),(0,P.x)(()=>this.loadingService.setLoadingStatus(!1)),(0,p.sL)(this.destroyRef)).subscribe(r=>{r&&(this.patchForm(r),this.cdr.markForCheck())})}patchForm(r){this.profileForm.patchValue({...r})}setFormAsDirty(r){Object.keys(r.controls).forEach(o=>{r.controls[o].markAsDirty()})}setPhonePrefixOnInputChange(){this.profileForm.controls.phone_number.valueChanges.pipe((0,S.h)(r=>!!r.length&&!r.includes("+")),(0,p.sL)(this.destroyRef)).subscribe(r=>{this.profileForm.controls.phone_number.patchValue(`+7${r}`,{emitEvent:!1})})}static#e=this.\u0275fac=function(o){return new(o||t)};static#t=this.\u0275cmp=e.Xpm({type:t,selectors:[["app-profile"]],decls:38,vars:7,consts:[[1,"profile"],[1,"profile__header"],[1,"profile__data","profile-data",3,"formGroup"],[1,"profile-data__first-name"],["id","first-name","pInputText","","formControlName","first_name","maxlength","255","required",""],["for","first-name"],["class","error-msg",4,"ngIf"],[1,"profile-data__last-name"],["id","last-name","pInputText","","formControlName","last_name","maxlength","255","required",""],["for","last-name"],[1,"profile-data__email"],["id","email","pInputText","","formControlName","email",3,"readOnly"],["for","email"],[1,"profile-data__phone-number"],["id","phone-number","pInputText","","formControlName","phone_number","maxlength","12","appPhoneInput",""],["for","phone-number"],[1,"profile-data__url"],["id","url","pInputText","","formControlName","url","type","email"],["for","url"],[1,"profile__submit"],["label","\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",3,"onClick"],["key","success"],["key","error"],[1,"error-msg"]],template:function(o,i){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2,"\u041f\u0440\u043e\u0444\u0438\u043b\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"),e.qZA(),e.TgZ(3,"div",2)(4,"div",3)(5,"p-floatLabel"),e._UZ(6,"input",4),e.TgZ(7,"label",5),e._uU(8,"\u0418\u043c\u044f"),e.qZA()(),e.YNc(9,L,2,0,"div",6),e.qZA(),e.TgZ(10,"div",7)(11,"p-floatLabel"),e._UZ(12,"input",8),e.TgZ(13,"label",9),e._uU(14,"\u0424\u0430\u043c\u0438\u043b\u0438\u044f"),e.qZA()(),e.YNc(15,z,2,0,"div",6),e.qZA(),e.TgZ(16,"div",10)(17,"p-floatLabel"),e._UZ(18,"input",11),e.TgZ(19,"label",12),e._uU(20,"Email"),e.qZA()(),e.YNc(21,B,2,0,"div",6),e.qZA(),e.TgZ(22,"div",13)(23,"p-floatLabel"),e._UZ(24,"input",14),e.TgZ(25,"label",15),e._uU(26,"\u041d\u043e\u043c\u0435\u0440 \u0442\u0435\u043b\u0435\u0444\u043e\u043d\u0430"),e.qZA()(),e.YNc(27,J,2,0,"div",6),e.qZA(),e.TgZ(28,"div",16)(29,"p-floatLabel"),e._UZ(30,"input",17),e.TgZ(31,"label",18),e._uU(32,"\u0410\u0434\u0440\u0435\u0441 \u0441\u0430\u0439\u0442\u0430"),e.qZA()(),e.YNc(33,Q,2,0,"div",6),e.qZA()(),e.TgZ(34,"div",19)(35,"p-button",20),e.NdJ("onClick",function(){return i.saveChanges()}),e.qZA()()(),e._UZ(36,"p-toast",21)(37,"p-toast",22)),2&o){let l,s,f,m,d;e.xp6(3),e.Q6J("formGroup",i.profileForm),e.xp6(6),e.Q6J("ngIf",null!==(l=null==i.profileForm.controls.first_name.errors?null:i.profileForm.controls.first_name.errors.required)&&void 0!==l&&l),e.xp6(6),e.Q6J("ngIf",null!==(s=null==i.profileForm.controls.last_name.errors?null:i.profileForm.controls.last_name.errors.required)&&void 0!==s&&s),e.xp6(3),e.Q6J("readOnly",!0),e.xp6(3),e.Q6J("ngIf",null!==(f=null==i.profileForm.controls.email.errors?null:i.profileForm.controls.email.errors.email)&&void 0!==f&&f),e.xp6(6),e.Q6J("ngIf",null!==(m=null==i.profileForm.controls.phone_number.errors?null:i.profileForm.controls.phone_number.errors.required)&&void 0!==m&&m),e.xp6(6),e.Q6J("ngIf",null!==(d=null==i.profileForm.controls.url.errors?null:i.profileForm.controls.url.errors.invalidUrl)&&void 0!==d&&d)}},dependencies:[h.O5,y.X,n.Fj,n.JJ,n.JL,n.Q7,n.nD,n.sg,n.u,D.o,I.zx,E.FN,O],styles:[".profile[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.profile__header[_ngcontent-%COMP%]{font-weight:700;font-size:28px}.profile__data[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.profile-data__first-name[_ngcontent-%COMP%], .profile-data__last-name[_ngcontent-%COMP%], .profile-data__email[_ngcontent-%COMP%], .profile-data__phone-number[_ngcontent-%COMP%], .profile-data__url[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.error-msg[_ngcontent-%COMP%]{color:red}"]})}return t})()}];let Y=(()=>{class t{static#e=this.\u0275fac=function(o){return new(o||t)};static#t=this.\u0275mod=e.oAB({type:t});static#r=this.\u0275inj=e.cJS({imports:[v.Bz.forChild(V),v.Bz]})}return t})(),j=(()=>{class t{static#e=this.\u0275fac=function(o){return new(o||t)};static#t=this.\u0275mod=e.oAB({type:t});static#r=this.\u0275inj=e.cJS({providers:[Z.ez],imports:[Y,h.ez,y.b,n.UX,D.j,I.zx,E.EV]})}return t})()}}]);